<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.3.14 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC3161 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.3161.xml">
<!ENTITY RFC5280 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5280.xml">
<!ENTITY RFC5035 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5035.xml">
<!ENTITY RFC7515 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7515.xml">
<!ENTITY RFC8174 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
]>

<?rfc toc="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>

<rfc ipr="trust200902" docName="draft-santesson-svt-pdf-00" category="std" consensus="true">

  <front>
    <title>Signature Validation Token</title>

    <author initials="S." surname="Santesson" fullname="Stefan Santesson">
      <organization abbrev="IDsec Solutions">IDsec Solutions AB</organization>
      <address>
        <postal>
          <street>Forskningsbyn Ideon</street>
          <city>Lund</city>
          <code>223 70</code>
          <country>SE</country>
        </postal>
        <email>sts@aaa-sec.com</email>
      </address>
    </author>
    <author initials="R." surname="Housley" fullname="Russ Housley">
      <organization abbrev="Vigil Security">Vigil Security, LLC</organization>
      <address>
        <postal>
          <street>516 Dranesville Road</street>
          <city>Herndon, VA</city>
          <code>20170</code>
          <country>US</country>
        </postal>
        <email>housley@vigilsec.com</email>
      </address>
    </author>

    <date year="2020" month="October" day="21"/>

    <area>Security</area>
    
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>This document defines a PDF profile for the Signature Validation Token defined in <xref target="SVT"/>.</t>



    </abstract>


  </front>

  <middle>


<section anchor="intro" title="Introduction">

<t>The “Signature Validation Token” specification <xref target="SVT"/> defines a basic token to support signature validation in a way that can significantly extend the lifetime of a signature.</t>

<t>This specification defines a profile for implementing SVT with a signed PDF document, and defines the following aspects of SVT usage:</t>

<t><list style="symbols">
  <t>How to include reference data related to PDF signatures and PDF documents in an SVT.</t>
  <t>How to add an SVT token to a PDF document.</t>
</list></t>

<t>PDF document signatures are added as incremental updates to the signed PDF document and signs all data of the PDF document up until the current signature. When more than one signature is added to a PDF document the previous signature is signed by the next signature and can not be updated with additional data after this event.</t>

<t>To minimize the impact on PDF documents with multiple signatures and to stay backwards compatible with PDF software that do not understand SVT, PDF documents add one SVT token for all signatures of the PDF as an extension to a document timestamp added to the signed PDF as an incremental update. This SVT covers all signatures of the signed SVT.</t>

</section>
<section anchor="defs" title="Definitions">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”,
“SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and “OPTIONAL” in this
document are to be interpreted as described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/>
when, and only when, they appear in all capitals, as shown here.</t>

<t>The definitions in <xref target="SVT"/> apply also to this document.</t>

</section>
<section anchor="svt-in-pdf" title="SVT in PDF Documents">

<t>An SVT added to a signed PDF document SHALL be added to a document timestamp accordance with ISO 32000-2:2017 <xref target="ISOPDF2"/>.</t>

<t>The document timestamp contains an <xref target="RFC3161"/> timestamp token (TSTInfo) in EncapsulatedContentInfo of the CMS signature. The SVT SHALL be added to the timestamp token (TSTInfo) as an Extension object as defined in  <xref target="svt-extension-to-timestamps"/>.</t>

<section anchor="svt-extension-to-timestamps" title="SVT Extension to Timestamp Tokens">

<t>The SVT extension is an Extension suitable to be included in TSTInfo as defined by <xref target="RFC3161"/>.</t>

<t>The SVT extension is identified by the Object Identifier (OID) 1.2.752.201.5.2</t>

<t>Editors note: This is the current used OID. Consider assigning an IETF extension OID.</t>

<t>This extension data (OCTET STRING) holds the bytes of SVT JWT, represented as a UTF-8 encoded string.</t>

<t>This extension SHALL NOT be marked critical.</t>

<t>Note: Extensions in timestamp tokens according to <xref target="RFC3161"/> are imported from the definition of the X.509 certificate extensions defined in <xref target="RFC5280"/>.</t>

</section>
</section>
<section anchor="svt-claims" title="SVT Claims">

<section anchor="signature-reference-data" title="Signature Reference Data">

<t>The SVT SHALL contain a SigReference claims object that SHALL contain the following data:</t>

<t><list style="symbols">
  <t>id – Absent or a Null value.</t>
  <t>sig_hash – The hash over the signature value bytes.</t>
  <t>sb_hash – The hash over the DER encoded SignedAttributes in SignerInfo.</t>
</list></t>

</section>
<section anchor="signed-data-reference" title="Signed Data Reference Data">

<t>An SVT according to this profile SHALL contain exactly one instance of the <spanx style="strong">SignedData</spanx> claims object. The <spanx style="strong">SignedData</spanx> claims object shall contain the following data:</t>

<t><list style="symbols">
  <t>ref – The string representation of the ByteRange value of the PDF signature dictionary of the target signature. This is a sequence of integers separated by space where each integer pair specifies the start index and length of a byte range.</t>
  <t>hash – The hash of all bytes identified by the ByteRange value. This is the concatenation of all byte ranges identified by the ByteRange value.</t>
</list></t>

</section>
<section anchor="signer-certificate-references" title="Signer Certificate References">

<t>The SVT SHALL contain a CertReference claims object. The type claim of the CertReference claims object SHALL be either chain or chain_hash`.</t>

<t><list style="symbols">
  <t>The chain type SHALL be used when signature validation was performed using one or more certificates where some or all of the certificates in the chain are not present in the target signature.</t>
  <t>The chain_hash type SHALL be used when signature validation was performed using one or more certificates where all of the certificates are present in the target signature.</t>
</list></t>

<t>Note: The referenced signer certificate MUST match any certificates referenced using ESSCertID or ESSCertIDv2 from <xref target="RFC5035"/>.</t>

</section>
</section>
<section anchor="jose-header" title="JOSE Header">

<section anchor="svt-signing-key-reference" title="SVT Signing Key Reference">

<t>The SVT JOSE header must contain one of the following header parameters in accordance with <xref target="RFC7515"/>, for storing a reference to the public key used to verify the signature on the SVT:</t>

<t><list style="symbols">
  <t>x5c – Holds an X.509 certificate <xref target="RFC5280"/> or a chain of certificates. The certificate holding the public key that verifies the signature on the SVT MUST be the first certificate in the chain.</t>
  <t>kid – A key identifier holding the Base64 encoded hash value of the certificate that can verify the signature on the SVT. The hash algorithm MUST be the same hash algorithm used when signing the SVT as specified by the <spanx style="verb">alg</spanx> header parameter. The referenced certificate SHOULD be the same certificate that was used to sign the document timestamp that contains the SVT.</t>
</list></t>

</section>
</section>


  </middle>

  <back>

    <references title='Normative References'>

&RFC2119;
&RFC3161;
&RFC5280;
&RFC5035;
&RFC7515;
&RFC8174;
<reference anchor="ISOPDF2" >
  <front>
    <title>Document management -- Portable document format -- Part 2: PDF 2.0</title>
    <author >
      <organization>ISO</organization>
    </author>
    <date year="2017" month="July"/>
  </front>
  <seriesInfo name="ISO" value="32000-2"/>
</reference>
<reference anchor="PADES" >
  <front>
    <title>Electronic Signatures and Infrastructures (ESI); PAdES digital signatures; Part 1: Building blocks and PAdES baseline signatures</title>
    <author >
      <organization>ETSI</organization>
    </author>
    <date year="2016" month="April"/>
  </front>
  <seriesInfo name="ETSI" value="EN 319 142-1 v1.1.1"/>
</reference>
<reference anchor="SVT" >
  <front>
    <title>Signature Validation Token</title>
    <author initials="S." surname="Santesson" fullname="Stefan Santesson">
      <organization></organization>
    </author>
    <author initials="R." surname="Housley" fullname="Russ Housley">
      <organization></organization>
    </author>
    <date year="2020" month="October"/>
  </front>
  <seriesInfo name="IETF" value="draft-santesson-svt-00"/>
</reference>


    </references>




  </back>

<!-- ##markdown-source:
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

-->

</rfc>

