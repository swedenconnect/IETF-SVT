<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.3.14 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC3161 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.3161.xml">
<!ENTITY RFC5280 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5280.xml">
<!ENTITY RFC5035 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5035.xml">
<!ENTITY RFC7515 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7515.xml">
<!ENTITY RFC8174 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
]>

<?rfc toc="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>

<rfc ipr="trust200902" docName="draft-santesson-svt-pdf-01" category="std" consensus="true">

  <front>
    <title>PDF Signature Validation Token</title>

    <author initials="S." surname="Santesson" fullname="Stefan Santesson">
      <organization abbrev="IDsec Solutions">IDsec Solutions AB</organization>
      <address>
        <postal>
          <street>Forskningsbyn Ideon</street>
          <city>Lund</city>
          <code>223 70</code>
          <country>SE</country>
        </postal>
        <email>sts@aaa-sec.com</email>
      </address>
    </author>
    <author initials="R." surname="Housley" fullname="Russ Housley">
      <organization abbrev="Vigil Security">Vigil Security, LLC</organization>
      <address>
        <postal>
          <street>516 Dranesville Road</street>
          <city>Herndon, VA</city>
          <code>20170</code>
          <country>US</country>
        </postal>
        <email>housley@vigilsec.com</email>
      </address>
    </author>

    <date year="2021" month="May" day="20"/>

    <area>Security</area>
    
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>This document defines a PDF profile for the Signature Validation Token defined in <xref target="SVT"/>.</t>



    </abstract>


  </front>

  <middle>


<section anchor="intro" title="Introduction">

<t>The “Signature Validation Token” specification <xref target="SVT"/> defines a basic token to support signature validation in a way that can significantly extend the lifetime of a signature.</t>

<t>This specification defines a profile for implementing SVT with a signed PDF document, and defines the following aspects of SVT usage:</t>

<t><list style="symbols">
  <t>How to include reference data related to PDF signatures and PDF documents in an SVT.</t>
  <t>How to add an SVT token to a PDF document.</t>
</list></t>

<t>PDF document signatures are added as incremental updates to the signed PDF document and signs all data of the PDF document up until the current signature. When more than one signature is added to a PDF document the previous signature is signed by the next signature and can not be updated with additional data after this event.</t>

<t>To minimize the impact on PDF documents with multiple signatures and to stay backwards compatible with PDF software that do not understand SVT, PDF documents add one SVT token for all signatures of the PDF as an extension to a document timestamp added to the signed PDF as an incremental update. This SVT covers all signatures of the signed SVT.</t>

</section>
<section anchor="defs" title="Definitions">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”,
“SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and “OPTIONAL” in this
document are to be interpreted as described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/>
when, and only when, they appear in all capitals, as shown here.</t>

<t>The definitions in <xref target="SVT"/> apply also to this document.</t>

</section>
<section anchor="svt-in-pdf" title="SVT in PDF Documents">

<t>An SVT added to a signed PDF document SHALL be added to a document timestamp accordance with ISO 32000-2:2017 <xref target="ISOPDF2"/>.</t>

<t>The document timestamp contains an <xref target="RFC3161"/> timestamp token (TSTInfo) in EncapsulatedContentInfo of the CMS signature. The SVT SHALL be added to the timestamp token (TSTInfo) as an Extension object as defined in  <xref target="svt-extension-to-timestamps"/>.</t>

<section anchor="svt-extension-to-timestamps" title="SVT Extension to Timestamp Tokens">

<t>The SVT extension is an Extension suitable to be included in TSTInfo as defined by <xref target="RFC3161"/>.</t>

<t>The SVT extension is identified by the Object Identifier (OID) 1.2.752.201.5.2</t>

<t>Editors note: This is the current used OID. Consider assigning an IETF extension OID.</t>

<t>This extension data (OCTET STRING) holds the bytes of SVT JWT, represented as a UTF-8 encoded string.</t>

<t>This extension SHALL NOT be marked critical.</t>

<t>Note: Extensions in timestamp tokens according to <xref target="RFC3161"/> are imported from the definition of the X.509 certificate extensions defined in <xref target="RFC5280"/>.</t>

</section>
</section>
<section anchor="svt-claims" title="SVT Claims">

<section anchor="signature-reference-data" title="Signature Reference Data">

<t>The SVT SHALL contain a SigReference claims object that SHALL contain the following data:</t>

<t><list style="symbols">
  <t>id – Absent or a Null value.</t>
  <t>sig_hash – The hash over the signature value bytes.</t>
  <t>sb_hash – The hash over the DER encoded SignedAttributes in SignerInfo.</t>
</list></t>

</section>
<section anchor="signed-data-reference" title="Signed Data Reference Data">

<t>An SVT according to this profile SHALL contain exactly one instance of the <spanx style="strong">SignedData</spanx> claims object. The <spanx style="strong">SignedData</spanx> claims object shall contain the following data:</t>

<t><list style="symbols">
  <t>ref – The string representation of the ByteRange value of the PDF signature dictionary of the target signature. This is a sequence of integers separated by space where each integer pair specifies the start index and length of a byte range.</t>
  <t>hash – The hash of all bytes identified by the ByteRange value. This is the concatenation of all byte ranges identified by the ByteRange value.</t>
</list></t>

</section>
<section anchor="signer-certificate-references" title="Signer Certificate References">

<t>The SVT SHALL contain a CertReference claims object. The type claim of the CertReference claims object SHALL be either chain or chain_hash`.</t>

<t><list style="symbols">
  <t>The chain type SHALL be used when signature validation was performed using one or more certificates where some or all of the certificates in the chain are not present in the target signature.</t>
  <t>The chain_hash type SHALL be used when signature validation was performed using one or more certificates where all of the certificates are present in the target signature.</t>
</list></t>

<t>Note: The referenced signer certificate MUST match any certificates referenced using ESSCertID or ESSCertIDv2 from <xref target="RFC5035"/>.</t>

</section>
</section>
<section anchor="jose-header" title="JOSE Header">

<section anchor="svt-signing-key-reference" title="SVT Signing Key Reference">

<t>The SVT JOSE header must contain one of the following header parameters in accordance with <xref target="RFC7515"/>, for storing a reference to the public key used to verify the signature on the SVT:</t>

<t><list style="symbols">
  <t>x5c – Holds an X.509 certificate <xref target="RFC5280"/> or a chain of certificates. The certificate holding the public key that verifies the signature on the SVT MUST be the first certificate in the chain.</t>
  <t>kid – A key identifier holding the Base64 encoded hash value of the certificate that can verify the signature on the SVT. The hash algorithm MUST be the same hash algorithm used when signing the SVT as specified by the <spanx style="verb">alg</spanx> header parameter. The referenced certificate SHOULD be the same certificate that was used to sign the document timestamp that contains the SVT.</t>
</list></t>

</section>
</section>


  </middle>

  <back>

    <references title='Normative References'>

&RFC2119;
&RFC3161;
&RFC5280;
&RFC5035;
&RFC7515;
&RFC8174;
<reference anchor="ISOPDF2" >
  <front>
    <title>Document management -- Portable document format -- Part 2: PDF 2.0</title>
    <author >
      <organization>ISO</organization>
    </author>
    <date year="2017" month="July"/>
  </front>
  <seriesInfo name="ISO" value="32000-2"/>
</reference>
<reference anchor="PADES" >
  <front>
    <title>Electronic Signatures and Infrastructures (ESI); PAdES digital signatures; Part 1: Building blocks and PAdES baseline signatures</title>
    <author >
      <organization>ETSI</organization>
    </author>
    <date year="2016" month="April"/>
  </front>
  <seriesInfo name="ETSI" value="EN 319 142-1 v1.1.1"/>
</reference>
<reference anchor="SVT" >
  <front>
    <title>Signature Validation Token</title>
    <author initials="S." surname="Santesson" fullname="Stefan Santesson">
      <organization></organization>
    </author>
    <author initials="R." surname="Housley" fullname="Russ Housley">
      <organization></organization>
    </author>
    <date year="2020" month="October"/>
  </front>
  <seriesInfo name="IETF" value="draft-santesson-svt-00"/>
</reference>


    </references>




  </back>

<!-- ##markdown-source:
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
S93Lk0dm3V5v6uFmTEHF1moprueemOLdQqOPS6hhRBPSGjFeTVU2rhV293eH
MBLthi6Z0b3sbE5pYtQE2VUJ1sSQWRJHxlTbvy65WdI2ssQ9U7OqO1M9lpYB
BP7c/IVj48lNDYPEseKZBRrmJUEIxrpvBZWRa3iHYZMP1rOxE5kLVxO9FgO3
seC4vJpquxESPzCigPZpMgBJWse2AQ5v3ngLSOObN91oe9J7aQf6jmtFL6cC
plfR8qXRFBBvQ/MTYnzD1W0V89ag0qQjk+5mwotNtW55cStsl6s9T6AziT9K
EdylxnxLs4gRa164qQ90ZDC/CeqykC14uqy2sTWXRXV9CLM+Qocbi8QI9sM1
6FyoW/Qsd/MggLCCrHco2YXIwnVtTya7jLjle6/LdVpRpao6WpUkr/B/kdeA
rWDnreKvMWcqvBVxixwa2JkXCpYE7qlYjyG7WYfvdXfdf6RpsQITAexNl6RG
hwdXfb+5IJNov+gU1OdcT6DB6fnb5QM4ey0K+vUG+0pDiKTagAZ3D2n5bwIy
jF65dQp88KCzK4DfG0NUTLN6wHi1uIPTtgeeU/7fbuwznyz+U2tDgyKTa1T4
GyDlqIUpN5mvuEUxcbXpamqd9BZPkoSwMB2T3fXL/dD3MN+F+scnoQv9fJ1M
2IXg1OYfD3/XRsRL9/ZUT0hJ6P1/w8TcIMz3rDAXxLhOdAi1ArYT7wXi8mZs
jXEX18UWwYWNRCYrjPuFv59vDbTOA/rl8enpyN3GDAYaN5u0fggIU+S6nOcy
dZcdl3t8RmORi81WS9I+Re5HMYDox0lKVHPhJhaMPLstvtXMfS8MJbXoJMfX
avscDUGuv3SNc13YWVYz4zO2eRzM/T15IQsKZ0t2u2SoFO5Cx3YaZDMZtm34
xI1497busK5mOr2iraD+7ehPYthrSJrnt0iOXa46thukd3u9W5uVfa4r1z86
NWz8Gw7+toOX3nYtta0P19S2CTvOEQNUQCEz/Mi3ez3ykajuSJXb0X8BOnc3
qPEZAAA=

-->

</rfc>

