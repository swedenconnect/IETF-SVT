<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.3.14 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC3161 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.3161.xml">
<!ENTITY RFC5280 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5280.xml">
<!ENTITY RFC5035 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5035.xml">
<!ENTITY RFC7515 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7515.xml">
<!ENTITY RFC8174 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
]>

<?rfc toc="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>

<rfc ipr="trust200902" docName="draft-santesson-svt-pdf-02" category="info" consensus="true">

  <front>
    <title>PDF Signature Validation Token</title>

    <author initials="S." surname="Santesson" fullname="Stefan Santesson">
      <organization abbrev="IDsec Solutions">IDsec Solutions AB</organization>
      <address>
        <postal>
          <street>Forskningsbyn Ideon</street>
          <city>Lund</city>
          <code>223 70</code>
          <country>SE</country>
        </postal>
        <email>sts@aaa-sec.com</email>
      </address>
    </author>
    <author initials="R." surname="Housley" fullname="Russ Housley">
      <organization abbrev="Vigil Security">Vigil Security, LLC</organization>
      <address>
        <postal>
          <street>516 Dranesville Road</street>
          <city>Herndon, VA</city>
          <code>20170</code>
          <country>US</country>
        </postal>
        <email>housley@vigilsec.com</email>
      </address>
    </author>

    <date year="2021" month="September" day="03"/>

    <area>Security</area>
    
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>This document defines a PDF profile for the Signature Validation Token defined in <xref target="SVT"/>.</t>



    </abstract>


  </front>

  <middle>


<section anchor="intro" title="Introduction">

<t>The “Signature Validation Token” specification <xref target="SVT"/> defines a basic token to support signature validation in a way that can significantly extend the lifetime of a signature.</t>

<t>This specification defines a profile for implementing SVT with a signed PDF document, and defines the following aspects of SVT usage:</t>

<t><list style="symbols">
  <t>How to include reference data related to PDF signatures and PDF documents in an SVT.</t>
  <t>How to add an SVT token to a PDF document.</t>
</list></t>

<t>PDF document signatures are added as incremental updates to the signed PDF document and signs all data of the PDF document up until the current signature. When more than one signature is added to a PDF document the previous signature is signed by the next signature and can not be updated with additional data after this event.</t>

<t>To minimize the impact on PDF documents with multiple signatures and to stay backwards compatible with PDF software that do not understand SVT, PDF documents add one SVT token for all signatures of the PDF as an extension to a document timestamp added to the signed PDF as an incremental update. This SVT covers all signatures of the signed PDF.</t>

</section>
<section anchor="defs" title="Definitions">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”,
“SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and “OPTIONAL” in this
document are to be interpreted as described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/>
when, and only when, they appear in all capitals, as shown here.</t>

<t>The definitions in <xref target="SVT"/> apply also to this document.</t>

</section>
<section anchor="svt-in-pdf" title="SVT in PDF Documents">

<t>The SVT for a signed PDF document MAY provide signature validation information about any of the present signatures in the PDF. The SVT MUST contain a separate “sig” claim (Signature object) for each signature on the PDF that is covered by the SVT.</t>

<t>An SVT added to a signed PDF document MUST be added to a document timestamp accordance with ISO 32000-2:2017 <xref target="ISOPDF2"/>.</t>

<t>The document timestamp contains an <xref target="RFC3161"/> timestamp token (TSTInfo) in EncapsulatedContentInfo of the CMS signature. The SVT MUST be added to the timestamp token (TSTInfo) as an Extension object as defined in  <xref target="svt-extension-to-timestamps"/>.</t>

<section anchor="svt-extension-to-timestamps" title="SVT Extension to Timestamp Tokens">

<t>The SVT extension is an Extension suitable to be included in TSTInfo as defined by <xref target="RFC3161"/>.</t>

<t>The SVT extension is identified by the Object Identifier (OID) 1.2.752.201.5.2</t>

<t>Editors note: This is the current used OID. Consider assigning an IETF extension OID.</t>

<t>This extension data (OCTET STRING) holds the bytes of SVT JWT, represented as a UTF-8 encoded string.</t>

<t>This extension MUST NOT be marked critical.</t>

<t>Note: Extensions in timestamp tokens according to <xref target="RFC3161"/> are imported from the definition of the X.509 certificate extensions defined in <xref target="RFC5280"/>.</t>

</section>
</section>
<section anchor="svt-claims" title="SVT Claims">

<section anchor="signature-reference-data" title="Signature Reference Data">

<t>The SVT Signature object MUST contain a “sig_ref” claim (SigReference object) with the following elements:</t>

<t><list style="symbols">
  <t>“id” – Absent or a Null value.</t>
  <t>“sig_hash” – The hash over the signature value bytes.</t>
  <t>“sb_hash” – The hash over the DER encoded SignedAttributes in SignerInfo.</t>
</list></t>

</section>
<section anchor="signed-data-reference" title="Signed Data Reference Data">

<t>The SVT Signature object MUST contain one instance of the “sig_data” claim (SignedData object) with the following elements:</t>

<t><list style="symbols">
  <t>“ref” – The string representation of the ByteRange value of the PDF signature dictionary of the target signature. This is a sequence of integers separated by space where each integer pair specifies the start index and length of a byte range.</t>
  <t>“hash” – The hash of all bytes identified by the ByteRange value. This is the concatenation of all byte ranges identified by the ByteRange value.</t>
</list></t>

</section>
<section anchor="signer-certificate-references" title="Signer Certificate References">

<t>The SVT Signature object MUST contain a “signer_cert_ref” claim (CertReference object). The “type” parameter of the “signer_cert_ref” claim MUST be either “chain” or “chain_hash”.</t>

<t><list style="symbols">
  <t>The “chain” type MUST be used when signature validation was performed using one or more certificates where some or all of the certificates in the chain are not present in the target signature.</t>
  <t>The “chain_hash” type MUST be used when signature validation was performed using one or more certificates where all of the certificates are present in the target signature.</t>
</list></t>

<t>Note: The referenced signer certificate MUST match any certificates referenced using ESSCertID or ESSCertIDv2 from <xref target="RFC5035"/>.</t>

</section>
</section>
<section anchor="jose-header" title="JOSE Header">

<section anchor="svt-signing-key-reference" title="SVT Signing Key Reference">

<t>The SVT JOSE header must contain one of the following header parameters in accordance with <xref target="RFC7515"/>, for storing a reference to the public key used to verify the signature on the SVT:</t>

<t><list style="symbols">
  <t>“x5c” – Holds an X.509 certificate <xref target="RFC5280"/> or a chain of certificates. The certificate holding the public key that verifies the signature on the SVT MUST be the first certificate in the chain.</t>
  <t>“kid” – A key identifier holding the Base64 encoded hash value of the certificate that can verify the signature on the SVT. The hash algorithm MUST be the same hash algorithm used when signing the SVT as specified by the <spanx style="verb">alg</spanx> header parameter. The referenced certificate SHOULD be the same certificate that was used to sign the document timestamp that contains the SVT.</t>
</list></t>

</section>
</section>
<section anchor="iana" title="IANA Considerations">

<t>This document has no IANA actions.</t>

</section>
<section anchor="seccons" title="Security Considerations">

<t>The security considerations of <xref target="SVT"/> applies also to this document.</t>

</section>


  </middle>

  <back>

    <references title='Normative References'>

&RFC2119;
&RFC3161;
&RFC5280;
&RFC5035;
&RFC7515;
&RFC8174;
<reference anchor="ISOPDF2" >
  <front>
    <title>Document management -- Portable document format -- Part 2: PDF 2.0</title>
    <author >
      <organization>ISO</organization>
    </author>
    <date year="2017" month="July"/>
  </front>
  <seriesInfo name="ISO" value="32000-2"/>
</reference>
<reference anchor="SVT" >
  <front>
    <title>Signature Validation Token</title>
    <author initials="S." surname="Santesson" fullname="Stefan Santesson">
      <organization></organization>
    </author>
    <author initials="R." surname="Housley" fullname="Russ Housley">
      <organization></organization>
    </author>
    <date year="2021" month="September"/>
  </front>
  <seriesInfo name="IETF" value="draft-santesson-svt-02"/>
</reference>


    </references>




  </back>

<!-- ##markdown-source:
H4sIAHcuMmEAA7VZXXPbuBV916/AyDOdZMbUSPI6TtSXdSyl1taxU0vJttPp
ZCESsrCmCJUA7age//eeewF+SXI2fWheQhLA/Tz33As5iqKO0y5VI/Fp/EHM
9F0mXZEr8UWmOpFOm0zMzb3KOomJM7nGviSXSxdZmTllrcki++CiTbKM+sMO
DmDDsD8cRP13Uf+kE+PDncm3I6GzpenEJrMqs4UdCZcXqtPRm5wfrRv2++8g
QeZKjsRMxUWu3bZzr7aPJk9GYgpteaZcNCbtnY51Mku+ytRkUJiZzkaPxD+d
iY+FNbnL1dLiabumh391OrJwK5OPOiLqCPzTGQyY9cSs9IG/eu9mTi1ltrNk
8juYMLYqFjOTFhQVK87f85pcLHL1sLfMaxaWKDcSH0xu7zOd3dnFNhPTRAW5
MXwciasiS/yrSWBBdzg8EWf9bvhUZI7iN5vwu1pLnY4g2P4spYygshebdafl
2W1PXJrCpmrb8Ou2sLb1mX36ou90WoX7WFxdXbScaq+3fDodvBFIRqbsg05T
JW6NTBpOXSJdicmOxZfzhm/D/uCs33bs86zp2Mpb+PMDKa68y0y+BhYfFFIo
bj9cDAeDd+HxZPBmEB5Ph2/75WP/5DQ8np0Oyse3g7Of6HE6uwHYhyNWHNDf
HZu4WKvMibXM5J3ixygSnwAnuYB/Sbm+ZGN4TeZODH3lDHshYxXWRI2c2Q2/
luUxOIv6Zz6YKtfKUm2UB7rY3IU5JyiIfjQkmbMv87apL1fpvglRkHsY899F
fevoDqhehFWLAl70cTL/QE4eopI+fO5EiK5cAGoyRrHPV9rW8U/UUgN1QnLc
N7lZaqQHWRFupb7DYOFgAn/E0xOC+vzc85rWOklSsNER0UxukiLmU09Hml6f
yQD13agLu1GxXurYfwzSG5YupNWxcGyGM8IWmw1wJWwl8qEWCfOkeJRbuAOY
xUgLbWPpmUu3Qn1zKkvY2VQvldNrJcwSZyppvRCytlW1Nc2Y6fUmZbCDnQhp
4lG7VRCGWFGIy8gfC3BuJYb0L02amkc6KUmXs2QICSksSmiE6AIbj+SxzuK0
SJQAIatcZbEioEi8psBLQjtIU+WBZVVN5ZbjkpH0Xi1WJkn4WAdXts4hFs3X
lgrEHQKgXpL0OOc4yFQUG0KxJWHk5YFQsHn0HVLS1PsC12l3a1uxEaA5UCit
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
1QlTL9zW/wvfhvUatxoAAA==

-->

</rfc>

