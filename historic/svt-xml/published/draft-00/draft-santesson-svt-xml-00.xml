<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.3.14 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC5280 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5280.xml">
<!ENTITY RFC7515 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7515.xml">
<!ENTITY RFC8174 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
]>

<?rfc toc="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>

<rfc ipr="trust200902" docName="draft-santesson-svt-xml-00" category="std" consensus="true">

  <front>
    <title>Signature Validation Token</title>

    <author initials="S." surname="Santesson" fullname="Stefan Santesson">
      <organization abbrev="IDsec Solutions">IDsec Solutions AB</organization>
      <address>
        <postal>
          <street>Forskningsbyn Ideon</street>
          <city>Lund</city>
          <code>223 70</code>
          <country>SE</country>
        </postal>
        <email>sts@aaa-sec.com</email>
      </address>
    </author>
    <author initials="R." surname="Housley" fullname="Russ Housley">
      <organization abbrev="Vigil Security">Vigil Security, LLC</organization>
      <address>
        <postal>
          <street>516 Dranesville Road</street>
          <city>Herndon, VA</city>
          <code>20170</code>
          <country>US</country>
        </postal>
        <email>housley@vigilsec.com</email>
      </address>
    </author>

    <date year="2020" month="October" day="21"/>

    <area>Security</area>
    
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>This document defines a XML profile for the Signature Validation Token defined in <xref target="SVT"/>.</t>



    </abstract>


  </front>

  <middle>


<section anchor="intro" title="Introduction">

<t>The “Signature Validation Token” specification <xref target="SVT"/> defines the basic token to support signature validation in a way that can significantly extend the lifetime of a signature.</t>

<t>This specification defines a profile for implementing SVT with a signed XML document, and defines the following aspects of SVT usage:</t>

<t><list style="symbols">
  <t>How to include reference data related to XML signatures and XML documents in an SVT.</t>
  <t>How to add an SVT token to a XML signature.</t>
</list></t>

<t>XML documents can have any number of signature elements, signing an arbitrary number of fragments of XML documents. The actual signature element may be included in the signed XML document (enveloped), include the signed data (enveloping) or may be separate from the signed content (detached).</t>

<t>To provide a generic solution for any type of XML signature an SVT is added to each XML signature element within the XML signature &lt;ds:Object&gt; element.</t>

</section>
<section anchor="defs" title="Definitions">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”,
“SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and “OPTIONAL” in this
document are to be interpreted as described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/>
when, and only when, they appear in all capitals, as shown here.</t>

<t>The definitions in <xref target="SVT"/> apply also to this document.</t>

<section anchor="notation" title="Notation">

<section anchor="ref-to-xml-elements" title="References to XML Elements from XML Schemas">

<t>When referring to elements from the W3C XML Signature namespace
(http://www.w3.org/2000/09/xmldsig#) the following syntax is used:</t>

<t><list style="symbols">
  <t>&lt;ds:Signature&gt;</t>
</list></t>

<t>When referring to elements from the ETSI XAdES XML Signature namespace
(http://uri.etsi.org/01903/v1.3.2#) the following syntax is used:</t>

<t><list style="symbols">
  <t>&lt;xades:CertDigest&gt;</t>
</list></t>

<t>When referring to elements defined in this specification
(http://id.swedenconnect.se/svt/1.0/sig-prop/ns) the following syntax is used:</t>

<t><list style="symbols">
  <t>&lt;svt:Element&gt;</t>
</list></t>

</section>
</section>
</section>
<section anchor="svt-in-pdf" title="SVT in XML Documents">

<t>When SVT is provided for XML signatures then one SVT SHALL be provided for each XML signature.</t>

<t>An SVT embedded within the XML signature element SHALL be placed in a  &lt;svt:SignatureValidationToken&gt; element as defined in <xref target="signaturevalidationtoken-signature-property"/>.</t>

<section anchor="signaturevalidationtoken-signature-property" title="SignatureValidationToken Signature Property">

<t>The &lt;svt:SignatureValidationToken&gt; element SHALL be placed in a &lt;ds:SignatureProperty&gt; element in accordance with <xref target="XMLDSIG11"/>. The &lt;ds:SignatureProperty&gt; element SHALL be placed inside a &lt;ds:SignatureProperties&gt; element inside a &lt;ds:Object&gt; element inside a &lt;ds:Signature&gt; element.</t>

<t>Note: <xref target="XMLDSIG11"/> requires the Target attribute to be present in &lt;ds:SignatureProperty&gt;, referencing the signature targeted by this signature property. If an SVT is added to a signature that do not have an Id attribute, implementations SHOULD add an Id attribute to the &lt;ds:Signature&gt; element and reference that Id in the Target attribute. This Id attribute and Target attribute value matching is required by the <xref target="XMLDSIG11"/> standard, but it is redundant in the context of SVT validation as the SVT already contains information that uniquely identifies the target signature. Validation applications SHOULD not reject an SVT token because of Id and Target attribute mismatch, and MUST rely on matching against signature using signed information in the SVT itself.</t>

<t>The &lt;svt:SignatureValidationToken&gt; element is defined by the following XML Schema:</t>

<figure><artwork><![CDATA[
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
    elementFormDefault="qualified"
    targetNamespace="http://id.swedenconnect.se/svt/1.0/sig-prop/ns"
    xmlns:svt="http://id.swedenconnect.se/svt/1.0/sig-prop/ns">

  <xs:element name="SignatureValidationToken"
      type="svt:SignatureValidationTokenType" />

  <xs:complexType name="SignatureValidationTokenType">
    <xs:simpleContent>
      <xs:extension base="xs:string">
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>

</xs:schema>
]]></artwork></figure>

<t>The SVT token SHALL be included as a string representation of the SVT JWT. Note that this is the string representation of the JWT without further encoding. The SVT MUST NOT be represented by the Base64 encoded bytes of the JWT string.</t>

<t>Example:</t>

<figure><artwork><![CDATA[
<ds:Signature Id="MySignatureId">
  ...
  <ds:Object>
    <ds:SignatureProperties>
      <ds:SignatureProperty Target="#MySignatureId">
        <svt:SignatureValidationToken>
              eyJ0eXAiOiJKV1QiLCJhb...2aNZ
        </svt:SignatureValidationToken>
      </ds:SignatureProperty>
    </ds:SignatureProperties>
  </ds:Object>
</ds:Signature>
]]></artwork></figure>

</section>
<section anchor="multiple-svt-tokens" title="Multiple SVT in a signature">

<t>If a new SVT is stored in a signature which already contains a previously issued SVT, implementations can choose to either replace the existing SVT or to store the new SVT in addition to the existing SVT.</t>

<t>If the new SVT is stored in addition to the old SVT, it SHOULD be stored in a new &lt;ds:SignatureProperty&gt; element inside the existing &lt;ds:SignatureProperties&gt; element where the old SVT is located.</t>

<t>For interoperability robustness, signature validation applications MUST be able to handle signatures where the new SVT is located in a new &lt;ds:Object&gt; element.</t>

</section>
</section>
<section anchor="svt-claims" title="SVT Claims">

<section anchor="signature-reference-data" title="Signature Reference Data">

<t>The SVT SHALL contain a SigReference claims object that SHALL contain the following data:</t>

<t><list style="symbols">
  <t>id – The Id-attribute of the XML signature, if present.</t>
  <t>sig_hash – The hash over the signature value bytes.</t>
  <t>sb_hash – The hash over the canonicalized &lt;ds:SignedInfo&gt; element (the bytes the XML signature algorithm has signed to generated the signature value).</t>
</list></t>

</section>
<section anchor="signed-data-reference" title="Signed Data Reference Data">

<t>An SVT according to this profile SHALL contain one instance of the SignedData claims object for each &lt;ds:Reference&gt; element in the &lt;ds:SignedInfo&gt; element. The SignedData claims object shall contain the following data:</t>

<t><list style="symbols">
  <t>ref – The value of the URI attribute of the corresponding &lt;ds:Reference&gt; element.</t>
  <t>hash – The hash of all bytes identified corresponding &lt;ds:Reference&gt; element after applying all identified canonicalization and transformation algorithms. These are the same bytes that is hashed by the hash value in the &lt;ds:DigestValue&gt; element inside the &lt;ds:Reference&gt; element.</t>
</list></t>

</section>
<section anchor="signer-certificate-references" title="Signer Certificate References">

<t>The SVT SHALL contain a CertReference claims object. The type claim of the CertReference claims object SHALL be either chain or chain_hash`.</t>

<t><list style="symbols">
  <t>The chain type SHALL be used when signature validation was performed using one or more certificates where some or all of the certificates in the chain are not present in the target signature.</t>
  <t>The chain_hash type SHALL be used when signature validation was performed using one or more certificates where all of the certificates are present in the target signature.</t>
</list></t>

</section>
</section>
<section anchor="jose-header" title="JOSE Header">

<section anchor="svt-signing-key-reference" title="SVT Signing Key Reference">

<t>The SVT JOSE header must contain one of the following header parameters in accordance with <xref target="RFC7515"/>, for storing a reference to the public key used to verify the signature on the SVT:</t>

<t><list style="symbols">
  <t>x5c – Holds an X.509 certificate <xref target="RFC5280"/> or a chain of certificates. The certificate holding the public key that verifies the signature on the SVT MUST be the first certificate in the chain.</t>
  <t>kid – A key identifier holding the Base64 encoded hash value of the certificate that can verify the signature on the SVT. The hash algorithm MUST be the same hash algorithm used when signing the SVT as specified by the <spanx style="verb">alg</spanx> header parameter.</t>
</list></t>

</section>
</section>


  </middle>

  <back>

    <references title='Normative References'>

&RFC2119;
&RFC5280;
&RFC7515;
&RFC8174;
<reference anchor="XMLDSIG11" >
  <front>
    <title>XML Signature Syntax and Processing Version 1.1</title>
    <author initials="D." surname="Eastlake" fullname="Donald Eastlake">
      <organization></organization>
    </author>
    <author initials="J." surname="Reagle" fullname="Joseph Reagle">
      <organization></organization>
    </author>
    <author initials="D." surname="Solo" fullname="David Solo">
      <organization></organization>
    </author>
    <author initials="F." surname="Hirsch" fullname="Frederick Hirsch">
      <organization></organization>
    </author>
    <author initials="M." surname="Nystrom" fullname="Magnus Nystrom">
      <organization></organization>
    </author>
    <author initials="T." surname="Roessler" fullname="Thomas Roessler">
      <organization></organization>
    </author>
    <author initials="K." surname="Yiu" fullname="Kelvin Yiu">
      <organization></organization>
    </author>
    <date year="2013" month="April" day="11"/>
  </front>
  <seriesInfo name="W3C" value="Proposed Recommendation"/>
</reference>
<reference anchor="SVT" >
  <front>
    <title>Signature Validation Token</title>
    <author initials="S." surname="Santesson" fullname="Stefan Santesson">
      <organization></organization>
    </author>
    <author initials="R." surname="Housley" fullname="Russ Housley">
      <organization></organization>
    </author>
    <date year="2020" month="October"/>
  </front>
  <seriesInfo name="IETF" value="draft-santesson-svt-00"/>
</reference>


    </references>




  </back>

<!-- ##markdown-source:
H4sIANf3kl8AA7Vaa3PbthL9zl+BkWc6zYxJSU7SNGqd1vWjkeNHailueh/T
QiQkoaYIlQAt63rU3353F+ADkvzInbn+EpLALvZxcHYBJQzDwEiTih4byEnG
TZELds1TmXAjVcaG6kZkQaLijM9gTpLzsQk1z4zQWmWhvjXh3SwNO50ABGDC
XmevE3Y74V43iOHDROXLHtMmCWKVaZHpQveYyQsRBHKe06M2e53O285ewHPB
wQoRF7k0y+BGLBcqT3qsD4vlmTDhES4eBNrwLPmdpyqD9TIVzGWP/dOoeJdp
lZtcjDU8LWf48O8g4IWZqrwXsDBg8CczMGAQsUHpAn21zg2MGPNsbUjlEzDh
SIuYDVRaYFA0O/iJxvholIvbjWEa02CJMD12onJ9k8lsokfLjPUT4fTG4GOP
nRVZYl9VAha09vZesjedlvtUZAbDNzimdzHjMsVg6h855yEsGcVqFnieXUXs
vSp0KpYNv64Krb3P5NO1nMi0CvcuOzs79Jzyxz2fXne/YZCMTOhbmaaCXSme
NJx6D+lKVLbLrg8avu11um86vmOfBk3HptbCH29x4cq7TOUzgOKtgBSyq5PD
vW73rXt8vfdtxz2+ed197R6/7b55hY+fz8+OBv2fu90eLeJA3oLPDaQPlpnh
dwwAxT7mKoa0Q6bYtcg1gr8bdW0qKhDBn422i/dRxI65Nim/Ee6zDfmRynia
+GOe4GnErgSfpL7YqdJiPm2OrK8GIFP+SvxWJvVnb/4JoEHmOp56Eie5SEQu
45vmoCd3HrGLJSQb4t8UPOeTrNDekCc2BJ8UhDAVuSc3nKoZ1/6YJ/ghYr/J
wpP5INJbmVWfS3Lpvgw7r8Ju18IRvBCQsLHqOdnWry8PW5BkyOUcQplAJAFE
M5FZNsNkDq6HPiAepr0ncr/BIo/yiCe6tk0f3Kgepz7kc/94eIJOb+PmDnBJ
EIYh7GpIGo+BPodTqRkQegFhMSwRYwn7mHHcL2yeq7GEDT1WOTNT8UhJcIIJ
+MPu7yGoq1VkV5rJJAHwBjtI3LlKipik7nckvq7QAPFo1Jmei1iOZWw/Ou2V
pWjXiGsZM0OGGMV0MZ8D9TNdKb2tlYKBnC34EgS5YTEkBqeR/sykSybuDOCD
1KZyLIycCabGIFNpi1zQfLvqyDWjJmfzVGBkkUfAcLaQZuqUQbQwyGXsd4l2
mm6NVZqqBUpyXMtoNASVFJpPgACDENCxQI9lFqdFIhgUOZGLLBYIFQ6vKSAm
wRm4UuWBpqWai2uKS4bao1otTxL3sQ4u91VBMHw9GNEpvxUguGRZMRuJHM2u
cyFsQLAqY+DRO1g6H0kAZN4UGed8YnXCi7dIxBA0AN+Cp5ua2QyyOxJlUAiT
GM4tMWdfi+xWpGoukhe7VRQbkymM5SSw9QUUy1I/cDPPIb5gqJo1haC3MaQ8
EYbHU9CNkFEIDCBnMJxNRIaUCx2K7REIKxgws5yL0t3aMZcDwBxkxOZTgOK1
WaX7CDHnsj/hq9R8l+je5ehPANNXE/NdKRLh9jxC5Enb0NzvAA6125zQeTFs
vTRrnX8aDFu79l92cUnPV8e/fOpfHR/h8+D9wdlZ9VDOGLy//HQG44F7qiUP
L8/Pjy+OrDB8ZWufzg9+a9l90br8OOxfXhyctWw6pQ6qJEKniCGhlENvOM8F
gh5KTCJ0nMuRhcBPhx+/ykZ6/l33FZCIax2ASOgZu4TVKlhMRWbXUxlwgX2F
QC4Zn88Fz2mXpCmAfC4NTwHDsIqeqgVgXjhmEHYPu0jWfIgqQCdIKbTWNHkX
E7DDLpRxHLeTuccVDuxA3XL7Wpd7+djtIgs+6mIAaVhX73eABUKjqBEvNxvo
+RWcsQSR46ZDDHk6EC9QL5nfEWEl0nMei+DrqTHzXru9WCyixcsImsY2dOqd
dudtG1ZKAGb/2nmxxlva9lPgaQHllxirRGG1BALxedYdDwd99vkgOR48aSQ0
qZEwWpKZne7bzsv2bTd6Ge0928Q7DujpHYrcHMmJ0OZJMxsV0GyUh8owmUR6
AQ1XBiSRwTaMtGhDZW53o04bQhgCR8zbmX6ulSDac1CwBsJGJqrIKERHFS3f
72D9l1k4T8YlGBynOFpKiITW6oTBeXCyorl2U8M28yQ2mQjQfGC1C+ByYqwH
OakkrVp3CnlMbJmuXKxSXXcH1Bw0Scxu+EYXUi1SV3+qYmE1QNGGDC+pW4F9
9tA6Dax9dCIY0S9YwDLDF/mzNSTru6c0x5PEmXEMlM2xFaCW4/6+OgCBs6w0
5klVm0ZoW8IekIZudM0Uf/5m8XlY5VqJAnqE7tdzBLbiX4V0QGVDnk8E4MAY
IP3ClEUB6oF2UXnM5d2qe6Kd7cq5TbohzeD+aOk2dzVUZjhi/fG2Qs2barDl
TBQDdi97JNZPaoN3636R2/LhCqZrxJpzbQ3ZzKK/JaCS1T0hLd+v+qH1cCEq
wHJvEVSwEVaAeyGgCzLxFEMFMi4NLj5iLUl0Q8PzZJeBOJPGSiQFfLRpQRFq
mu5M2eI2OnZus4tfeZoLnixpMpdUXsf2QkBl1r0ik38VAuosQAq67rF02LAZ
bHBU86CBldkRdRVyzFEuEKx+CzwSMQcORjsxUtviM5OagmM7CeqVcjQJVqqC
xidof/OMUtBdg2shm365ABGwjBbpOPofyETW5OhyVBeXunuAwvL3338H3/8A
FZ3d2muP/RbUphbDipXA7P3Wp+FJ+G3rh3fB93e6p0mOwXw4yN7p/dbWLqHb
hjXsEvYU7cw6ASeh7+RFavZbf0E3jwlL7BSbsYuytFean1lBrRJrFwx/sfi7
ABSgh2UEscnYbz0U7JY7fmMDv996LC1DmNFi7Up/rHDP3+HnJ9YgyXe0EIWe
yOLQHjbeufXJYjzC0o0VHIxBH8412K+0qlnt5jSnsr1NJ31tmAhm24mUzHcE
F0JjvUOqklEdwDgei60JsBMcH1twwzYqwX366zDCHtgRFfGstLv3UVmQoxqn
gFzGRQ6f8gqtttKh9vLIgoZVeurd8BNE6ptXVo6+GqGbC1gLYOcd33EMRrlT
mtQLhLDfOl9W7/2EAh5FEQayKn4u3NuLZ5WhbWXKUc1+a2dzFSf2GPLqafZP
LE874vOBvJSnH667v8izw9PpCKzd4xf/qDW2n6Py+/Y2e0tgPewqjZVh8Sc6
bEFXdg70ICHmZWfbLKn3OzM3ShdchEA87WAxZplYlPVYG5WXPVQtvZhKaF43
qgre4YhbiTdvUEi0LkAS9GyWZ7zsiKdKaSrHQhL2AF3YKxF0xJ3U1d0P3qIp
awkNVuZlWOClLWJqQy4ibzwBz581UZWWxpqyluFlRcN/VPPMPpI6M8+gZ/Z9
CzwPN+1Bo1OFPwIl4NAJ3o3hYR2F+UimEtCdq1GhTSa0uxvauLvz6jRtaPCM
j1KK/hSKbSqah5fahkbgnA0bkdh6K+JOU4cpl7PyDBXTy8o/L9QndHaEV0aN
w0FYNWAh3iatarq0ROlQB9aAtlqNXYYpMssyoj/fr+Gomo6FMmFhSKzXT8K6
J3FU5h2+ACLjsjvG21oc+X3K9bTUQM8K+oC1dtg2gMSRVm70iBjsEZVB1lL5
Hwh7Az4i6UOX46Hma7rNJe7dPCrydKJy2GIzXKBslCDxdJlm7zk3rXxBWbSZ
ghmUnK25Egmlp87WqjrF2rOUO+9TWSqveP2M4DkZmzo6dZWFjVTTOn5Gq6Oz
i0hl1PpJbq3J34yaq3EPLaSndGP1GGogheB2mT6bXWf/p6s+20ARhANQM1dZ
0mCErQ4QPDaxMaZbNJvoqlFPvkAv42MgD3ulRu00qGsqqjHnmAOv9HOe6bqt
ruBkr5OBwrljCw1dWIVCTr0zml03C+SEDZOfIHtVdI0jDxHpE9EqoZozvHqy
90eief/n0JqHcT1eg1Y/Qi+o8AF+sRCiy2f6Xib6EZG6zXNlL57SHnAPRAh/
UPpRtR2kBSo5vMmiK9btZL+ATQ7FARMG8+zpCHcYXsBjBW34X1K9VjMaRzSU
UG3OKo+aZAxmGw95jeuBrQfFpgeW5v7fbjxkPs/F09ZCyTq9HByz99DSQFbu
d/6E7iSc0psrWogN99PLB7Fs0KEtcO5nmfBGLD02LHFF6q1CNoOC7fGfs7um
GDcRfyqZCdizevvtlPvRfrXaJWbEdoX2dfP6wvY382IETQD9KkGhh89QauR4
uUb/qjo2U128ex0jB72HdgR//mKfo9edt834WiPwPxGsVgSiEtFjLwt2qzTl
pqCyvDJqGEfUQZaVdxDbbKvaGIqazDGcDd1NxCISb2x5P6AVKsLLPRvWjjIN
stoEVf0r6BMxjGr2rutw03YizbVxf2uU9lFJre7Ha1b9AwT/2MBLFPwXs+i8
BZQkAAA=

-->

</rfc>

