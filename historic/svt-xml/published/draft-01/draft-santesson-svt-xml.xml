<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.3.14 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC5280 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5280.xml">
<!ENTITY RFC7515 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7515.xml">
<!ENTITY RFC8174 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
]>

<?rfc toc="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>

<rfc ipr="trust200902" docName="draft-santesson-svt-xml-01" category="std" consensus="true">

  <front>
    <title>XML Signature Validation Token</title>

    <author initials="S." surname="Santesson" fullname="Stefan Santesson">
      <organization abbrev="IDsec Solutions">IDsec Solutions AB</organization>
      <address>
        <postal>
          <street>Forskningsbyn Ideon</street>
          <city>Lund</city>
          <code>223 70</code>
          <country>SE</country>
        </postal>
        <email>sts@aaa-sec.com</email>
      </address>
    </author>
    <author initials="R." surname="Housley" fullname="Russ Housley">
      <organization abbrev="Vigil Security">Vigil Security, LLC</organization>
      <address>
        <postal>
          <street>516 Dranesville Road</street>
          <city>Herndon, VA</city>
          <code>20170</code>
          <country>US</country>
        </postal>
        <email>housley@vigilsec.com</email>
      </address>
    </author>

    <date year="2021" month="May" day="20"/>

    <area>Security</area>
    
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>This document defines a XML profile for the Signature Validation Token defined in <xref target="SVT"/>.</t>



    </abstract>


  </front>

  <middle>


<section anchor="intro" title="Introduction">

<t>The “Signature Validation Token” specification <xref target="SVT"/> defines the basic token to support signature validation in a way that can significantly extend the lifetime of a signature.</t>

<t>This specification defines a profile for implementing SVT with a signed XML document, and defines the following aspects of SVT usage:</t>

<t><list style="symbols">
  <t>How to include reference data related to XML signatures and XML documents in an SVT.</t>
  <t>How to add an SVT token to a XML signature.</t>
</list></t>

<t>XML documents can have any number of signature elements, signing an arbitrary number of fragments of XML documents. The actual signature element may be included in the signed XML document (enveloped), include the signed data (enveloping) or may be separate from the signed content (detached).</t>

<t>To provide a generic solution for any type of XML signature an SVT is added to each XML signature element within the XML signature &lt;ds:Object&gt; element.</t>

</section>
<section anchor="defs" title="Definitions">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”,
“SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and “OPTIONAL” in this
document are to be interpreted as described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/>
when, and only when, they appear in all capitals, as shown here.</t>

<t>The definitions in <xref target="SVT"/> apply also to this document.</t>

<section anchor="notation" title="Notation">

<section anchor="ref-to-xml-elements" title="References to XML Elements from XML Schemas">

<t>When referring to elements from the W3C XML Signature namespace
(http://www.w3.org/2000/09/xmldsig#) the following syntax is used:</t>

<t><list style="symbols">
  <t>&lt;ds:Signature&gt;</t>
</list></t>

<t>When referring to elements from the ETSI XAdES XML Signature namespace
(http://uri.etsi.org/01903/v1.3.2#) the following syntax is used:</t>

<t><list style="symbols">
  <t>&lt;xades:CertDigest&gt;</t>
</list></t>

<t>When referring to elements defined in this specification
(http://id.swedenconnect.se/svt/1.0/sig-prop/ns) the following syntax is used:</t>

<t><list style="symbols">
  <t>&lt;svt:Element&gt;</t>
</list></t>

</section>
</section>
</section>
<section anchor="svt-in-pdf" title="SVT in XML Documents">

<t>When SVT is provided for XML signatures then one SVT SHALL be provided for each XML signature.</t>

<t>An SVT embedded within the XML signature element SHALL be placed in a  &lt;svt:SignatureValidationToken&gt; element as defined in <xref target="signaturevalidationtoken-signature-property"/>.</t>

<section anchor="signaturevalidationtoken-signature-property" title="SignatureValidationToken Signature Property">

<t>The &lt;svt:SignatureValidationToken&gt; element SHALL be placed in a &lt;ds:SignatureProperty&gt; element in accordance with <xref target="XMLDSIG11"/>. The &lt;ds:SignatureProperty&gt; element SHALL be placed inside a &lt;ds:SignatureProperties&gt; element inside a &lt;ds:Object&gt; element inside a &lt;ds:Signature&gt; element.</t>

<t>Note: <xref target="XMLDSIG11"/> requires the Target attribute to be present in &lt;ds:SignatureProperty&gt;, referencing the signature targeted by this signature property. If an SVT is added to a signature that do not have an Id attribute, implementations SHOULD add an Id attribute to the &lt;ds:Signature&gt; element and reference that Id in the Target attribute. This Id attribute and Target attribute value matching is required by the <xref target="XMLDSIG11"/> standard, but it is redundant in the context of SVT validation as the SVT already contains information that uniquely identifies the target signature. Validation applications SHOULD not reject an SVT token because of Id and Target attribute mismatch, and MUST rely on matching against signature using signed information in the SVT itself.</t>

<t>The &lt;svt:SignatureValidationToken&gt; element is defined by the following XML Schema:</t>

<figure><artwork><![CDATA[
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
    elementFormDefault="qualified"
    targetNamespace="http://id.swedenconnect.se/svt/1.0/sig-prop/ns"
    xmlns:svt="http://id.swedenconnect.se/svt/1.0/sig-prop/ns">

  <xs:element name="SignatureValidationToken"
      type="svt:SignatureValidationTokenType" />

  <xs:complexType name="SignatureValidationTokenType">
    <xs:simpleContent>
      <xs:extension base="xs:string">
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>

</xs:schema>
]]></artwork></figure>

<t>The SVT token SHALL be included as a string representation of the SVT JWT. Note that this is the string representation of the JWT without further encoding. The SVT MUST NOT be represented by the Base64 encoded bytes of the JWT string.</t>

<t>Example:</t>

<figure><artwork><![CDATA[
<ds:Signature Id="MySignatureId">
  ...
  <ds:Object>
    <ds:SignatureProperties>
      <ds:SignatureProperty Target="#MySignatureId">
        <svt:SignatureValidationToken>
              eyJ0eXAiOiJKV1QiLCJhb...2aNZ
        </svt:SignatureValidationToken>
      </ds:SignatureProperty>
    </ds:SignatureProperties>
  </ds:Object>
</ds:Signature>
]]></artwork></figure>

</section>
<section anchor="multiple-svt-tokens" title="Multiple SVT in a signature">

<t>If a new SVT is stored in a signature which already contains a previously issued SVT, implementations can choose to either replace the existing SVT or to store the new SVT in addition to the existing SVT.</t>

<t>If the new SVT is stored in addition to the old SVT, it SHOULD be stored in a new &lt;ds:SignatureProperty&gt; element inside the existing &lt;ds:SignatureProperties&gt; element where the old SVT is located.</t>

<t>For interoperability robustness, signature validation applications MUST be able to handle signatures where the new SVT is located in a new &lt;ds:Object&gt; element.</t>

</section>
</section>
<section anchor="svt-claims" title="SVT Claims">

<section anchor="signature-reference-data" title="Signature Reference Data">

<t>The SVT SHALL contain a SigReference claims object that SHALL contain the following data:</t>

<t><list style="symbols">
  <t>id – The Id-attribute of the XML signature, if present.</t>
  <t>sig_hash – The hash over the signature value bytes.</t>
  <t>sb_hash – The hash over the canonicalized &lt;ds:SignedInfo&gt; element (the bytes the XML signature algorithm has signed to generated the signature value).</t>
</list></t>

</section>
<section anchor="signed-data-reference" title="Signed Data Reference Data">

<t>An SVT according to this profile SHALL contain one instance of the SignedData claims object for each &lt;ds:Reference&gt; element in the &lt;ds:SignedInfo&gt; element. The SignedData claims object shall contain the following data:</t>

<t><list style="symbols">
  <t>ref – The value of the URI attribute of the corresponding &lt;ds:Reference&gt; element.</t>
  <t>hash – The hash of all bytes identified corresponding &lt;ds:Reference&gt; element after applying all identified canonicalization and transformation algorithms. These are the same bytes that is hashed by the hash value in the &lt;ds:DigestValue&gt; element inside the &lt;ds:Reference&gt; element.</t>
</list></t>

</section>
<section anchor="signer-certificate-references" title="Signer Certificate References">

<t>The SVT SHALL contain a CertReference claims object. The type claim of the CertReference claims object SHALL be either chain or chain_hash`.</t>

<t><list style="symbols">
  <t>The chain type SHALL be used when signature validation was performed using one or more certificates where some or all of the certificates in the chain are not present in the target signature.</t>
  <t>The chain_hash type SHALL be used when signature validation was performed using one or more certificates where all of the certificates are present in the target signature.</t>
</list></t>

</section>
</section>
<section anchor="jose-header" title="JOSE Header">

<section anchor="svt-signing-key-reference" title="SVT Signing Key Reference">

<t>The SVT JOSE header must contain one of the following header parameters in accordance with <xref target="RFC7515"/>, for storing a reference to the public key used to verify the signature on the SVT:</t>

<t><list style="symbols">
  <t>x5c – Holds an X.509 certificate <xref target="RFC5280"/> or a chain of certificates. The certificate holding the public key that verifies the signature on the SVT MUST be the first certificate in the chain.</t>
  <t>kid – A key identifier holding the Base64 encoded hash value of the certificate that can verify the signature on the SVT. The hash algorithm MUST be the same hash algorithm used when signing the SVT as specified by the <spanx style="verb">alg</spanx> header parameter.</t>
</list></t>

</section>
</section>


  </middle>

  <back>

    <references title='Normative References'>

&RFC2119;
&RFC5280;
&RFC7515;
&RFC8174;
<reference anchor="XMLDSIG11" >
  <front>
    <title>XML Signature Syntax and Processing Version 1.1</title>
    <author initials="D." surname="Eastlake" fullname="Donald Eastlake">
      <organization></organization>
    </author>
    <author initials="J." surname="Reagle" fullname="Joseph Reagle">
      <organization></organization>
    </author>
    <author initials="D." surname="Solo" fullname="David Solo">
      <organization></organization>
    </author>
    <author initials="F." surname="Hirsch" fullname="Frederick Hirsch">
      <organization></organization>
    </author>
    <author initials="M." surname="Nystrom" fullname="Magnus Nystrom">
      <organization></organization>
    </author>
    <author initials="T." surname="Roessler" fullname="Thomas Roessler">
      <organization></organization>
    </author>
    <author initials="K." surname="Yiu" fullname="Kelvin Yiu">
      <organization></organization>
    </author>
    <date year="2013" month="April" day="11"/>
  </front>
  <seriesInfo name="W3C" value="Proposed Recommendation"/>
</reference>
<reference anchor="SVT" >
  <front>
    <title>Signature Validation Token</title>
    <author initials="S." surname="Santesson" fullname="Stefan Santesson">
      <organization></organization>
    </author>
    <author initials="R." surname="Housley" fullname="Russ Housley">
      <organization></organization>
    </author>
    <date year="2020" month="October"/>
  </front>
  <seriesInfo name="IETF" value="draft-santesson-svt-00"/>
</reference>


    </references>




  </back>

<!-- ##markdown-source:
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
g6yl8j8Q9gZ8RNKHLsdDzTd0m0vcu3pU5OlY5bDFprhA2ShB4ukyzd5zrlr5
krJoMwUzKDlrcyUSSk+drYfqFGvPUu68T2WpvOL1M4LnZGzq6NRVFjZSTev4
Ga2Ozi4ilVHLJ7mlJn81aq7GbVpIT+jG6jHUQArB7TJ9NrvO/k+XfbaCIggH
oGamsqTBCGsdIHisYmNEt2g20VWjnnyFXsZHQB72So3aaVDXVFRjzjEHXunn
PNN1W13ByV4nA4VzxxYaurAKhZx6ZzS7bhbICRsmP0H2qugaRzYR6RPRKqGa
M7x6svdHonn/59Cah3E9XoNWP0IvqHADv1gI0eUzfS8T/YhI3ea5shdPaA+4
ByKEPyn9qNoO0gKVHN5k0RXrerKfwyaH4oAJg3n2dIQ7DC/gsYI2/C+pXqsp
jSMaSqg2Z5VHTTIGs42HvMb1wNqDYtMDS3P/bzc2mc9z8bS1ULJOLgZH7D20
NJCV+62/oDsJJ/TmihZiw/308kEsGnRoC5z7WSa8EQuPDUtckXqrkE2hYHv8
5+yuKcZNxJ9KpgL2rF5/O+V+tH942CZmxHaF9nXz+sL2N7NiCE0A/SpBoYfP
UGrkaLFE/6o6NlNdvNuNkYPeQzuCP3+xz9Fu520zvtYI/E8EDw8EohLRIy8L
dqs05SagsrwyahhH1EGWlXcQ62yr2hiKmswxnA3dTcQiEm9sed+nFSrCyz0b
lo4yDbJaBVX9K+gTMYxq9q7rcNN2Is2lcX9rlPZRSa3ux2tW/RME/1zBSxT8
F8LL+jqYJAAA

-->

</rfc>

