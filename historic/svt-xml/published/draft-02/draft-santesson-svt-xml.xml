<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.3.14 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC5280 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5280.xml">
<!ENTITY RFC7515 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7515.xml">
<!ENTITY RFC8174 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
]>

<?rfc toc="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>

<rfc ipr="trust200902" docName="draft-santesson-svt-xml-02" category="info" consensus="true">

  <front>
    <title>XML Signature Validation Token</title>

    <author initials="S." surname="Santesson" fullname="Stefan Santesson">
      <organization abbrev="IDsec Solutions">IDsec Solutions AB</organization>
      <address>
        <postal>
          <street>Forskningsbyn Ideon</street>
          <city>Lund</city>
          <code>223 70</code>
          <country>SE</country>
        </postal>
        <email>sts@aaa-sec.com</email>
      </address>
    </author>
    <author initials="R." surname="Housley" fullname="Russ Housley">
      <organization abbrev="Vigil Security">Vigil Security, LLC</organization>
      <address>
        <postal>
          <street>516 Dranesville Road</street>
          <city>Herndon, VA</city>
          <code>20170</code>
          <country>US</country>
        </postal>
        <email>housley@vigilsec.com</email>
      </address>
    </author>

    <date year="2021" month="September" day="03"/>

    <area>Security</area>
    
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>This document defines a XML profile for the Signature Validation Token defined in <xref target="SVT"/>.</t>



    </abstract>


  </front>

  <middle>


<section anchor="intro" title="Introduction">

<t>The “Signature Validation Token” specification <xref target="SVT"/> defines the basic token to support signature validation in a way that can significantly extend the lifetime of a signature.</t>

<t>This specification defines a profile for implementing SVT with a signed XML document, and defines the following aspects of SVT usage:</t>

<t><list style="symbols">
  <t>How to include reference data related to XML signatures and XML documents in an SVT.</t>
  <t>How to add an SVT token to a XML signature.</t>
</list></t>

<t>XML documents can have any number of signature elements, signing an arbitrary number of fragments of XML documents. The actual signature element may be included in the signed XML document (enveloped), include the signed data (enveloping) or may be separate from the signed content (detached).</t>

<t>To provide a generic solution for any type of XML signature an SVT is added to each XML signature element within the XML signature &lt;ds:Object&gt; element.</t>

</section>
<section anchor="defs" title="Definitions">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”,
“SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and “OPTIONAL” in this
document are to be interpreted as described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/>
when, and only when, they appear in all capitals, as shown here.</t>

<t>The definitions in <xref target="SVT"/> apply also to this document.</t>

<section anchor="notation" title="Notation">

<section anchor="ref-to-xml-elements" title="References to XML Elements from XML Schemas">

<t>When referring to elements from the W3C XML Signature namespace
(http://www.w3.org/2000/09/xmldsig#) the following syntax is used:</t>

<t><list style="symbols">
  <t>&lt;ds:Signature&gt;</t>
</list></t>

<t>When referring to elements from the ETSI XAdES XML Signature namespace
(http://uri.etsi.org/01903/v1.3.2#) the following syntax is used:</t>

<t><list style="symbols">
  <t>&lt;xades:CertDigest&gt;</t>
</list></t>

<t>When referring to elements defined in this specification
(http://id.swedenconnect.se/svt/1.0/sig-prop/ns) the following syntax is used:</t>

<t><list style="symbols">
  <t>&lt;svt:Element&gt;</t>
</list></t>

</section>
</section>
</section>
<section anchor="svt-in-xml" title="SVT in XML Documents">

<t>When SVT is provided for XML signatures then one SVT MUST be provided for each XML signature.</t>

<t>An SVT embedded within the XML signature element MUST be placed in a  &lt;svt:SignatureValidationToken&gt; element as defined in <xref target="signaturevalidationtoken-signature-property"/>.</t>

<section anchor="signaturevalidationtoken-signature-property" title="SignatureValidationToken Signature Property">

<t>The &lt;svt:SignatureValidationToken&gt; element MUST be placed in a &lt;ds:SignatureProperty&gt; element in accordance with <xref target="XMLDSIG11"/>. The &lt;ds:SignatureProperty&gt; element MUST be placed inside a &lt;ds:SignatureProperties&gt; element inside a &lt;ds:Object&gt; element inside a &lt;ds:Signature&gt; element.</t>

<t>Note: <xref target="XMLDSIG11"/> requires the Target attribute to be present in &lt;ds:SignatureProperty&gt;, referencing the signature targeted by this signature property. If an SVT is added to a signature that do not have an Id attribute, implementations SHOULD add an Id attribute to the &lt;ds:Signature&gt; element and reference that Id in the Target attribute. This Id attribute and Target attribute value matching is required by the <xref target="XMLDSIG11"/> standard, but it is redundant in the context of SVT validation as the SVT already contains information that uniquely identifies the target signature. Validation applications SHOULD not reject an SVT token because of Id and Target attribute mismatch, and MUST rely on matching against signature using signed information in the SVT itself.</t>

<t>The &lt;svt:SignatureValidationToken&gt; element is defined by the following XML Schema:</t>

<figure><artwork><![CDATA[
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
    elementFormDefault="qualified"
    targetNamespace="http://id.swedenconnect.se/svt/1.0/sig-prop/ns"
    xmlns:svt="http://id.swedenconnect.se/svt/1.0/sig-prop/ns">

  <xs:element name="SignatureValidationToken"
      type="svt:SignatureValidationTokenType" />

  <xs:complexType name="SignatureValidationTokenType">
    <xs:simpleContent>
      <xs:extension base="xs:string">
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>

</xs:schema>
]]></artwork></figure>

<t>The SVT token MUST be included as a string representation of the SVT JWT. Note that this is the string representation of the JWT without further encoding. The SVT MUST NOT be represented by the Base64 encoded bytes of the JWT string.</t>

<t>Example:</t>

<figure><artwork><![CDATA[
<ds:Signature Id="MySignatureId">
  ...
  <ds:Object>
    <ds:SignatureProperties>
      <ds:SignatureProperty Target="#MySignatureId">
        <svt:SignatureValidationToken>
              eyJ0eXAiOiJKV1QiLCJhb...2aNZ
        </svt:SignatureValidationToken>
      </ds:SignatureProperty>
    </ds:SignatureProperties>
  </ds:Object>
</ds:Signature>
]]></artwork></figure>

</section>
<section anchor="multiple-svt-tokens" title="Multiple SVT in a signature">

<t>If a new SVT is stored in a signature which already contains a previously issued SVT, implementations can choose to either replace the existing SVT or to store the new SVT in addition to the existing SVT.</t>

<t>If the new SVT is stored in addition to the old SVT, it SHOULD be stored in a new &lt;ds:SignatureProperty&gt; element inside the existing &lt;ds:SignatureProperties&gt; element where the old SVT is located.</t>

<t>For interoperability robustness, signature validation applications MUST be able to handle signatures where the new SVT is located in a new &lt;ds:Object&gt; element.</t>

</section>
</section>
<section anchor="svt-claims" title="SVT Claims">

<section anchor="signature-reference-data" title="Signature Reference Data">

<t>The SVT Signature object MUST contain a “sig_ref” claim (SigReference object) with the following elements:</t>

<t><list style="symbols">
  <t>“id” – The Id-attribute of the XML signature, if present.</t>
  <t>“sig_hash” – The hash over the signature value bytes.</t>
  <t>“sb_hash” – The hash over the canonicalized &lt;ds:SignedInfo&gt; element (the bytes the XML signature algorithm has signed to generated the signature value).</t>
</list></t>

</section>
<section anchor="signed-data-reference" title="Signed Data Reference Data">

<t>The SVT Signature object MUST contain one instance of the “sig_data” claim (SignedData object) for each &lt;ds:Reference&gt; element in the &lt;ds:SignedInfo&gt; element. The “sig_data” claim MUST contain the following elements:</t>

<t><list style="symbols">
  <t>“ref” – The value of the URI attribute of the corresponding &lt;ds:Reference&gt; element.</t>
  <t>“hash” – The hash of all bytes identified corresponding &lt;ds:Reference&gt; element after applying all identified canonicalization and transformation algorithms. These are the same bytes that is hashed by the hash value in the &lt;ds:DigestValue&gt; element inside the &lt;ds:Reference&gt; element.</t>
</list></t>

</section>
<section anchor="signer-certificate-references" title="Signer Certificate References">

<t>The SVT Signature object MUST contain a “signer_cert_ref” claim (CertReference object). The “type” parameter of the “signer_cert_ref” claim MUST be either “chain” or “chain_hash”.</t>

<t><list style="symbols">
  <t>The “chain” type MUST be used when signature validation was performed using one or more certificates where some or all of the certificates in the chain are not present in the target signature.</t>
  <t>The “chain_hash” type MUST be used when signature validation was performed using one or more certificates where all of the certificates are present in the target signature.</t>
</list></t>

</section>
</section>
<section anchor="jose-header" title="JOSE Header">

<section anchor="svt-signing-key-reference" title="SVT Signing Key Reference">

<t>The SVT JOSE header must contain one of the following header parameters in accordance with <xref target="RFC7515"/>, for storing a reference to the public key used to verify the signature on the SVT:</t>

<t><list style="symbols">
  <t>“x5c” – Holds an X.509 certificate <xref target="RFC5280"/> or a chain of certificates. The certificate holding the public key that verifies the signature on the SVT MUST be the first certificate in the chain.</t>
  <t>“kid” – A key identifier holding the Base64 encoded hash value of the certificate that can verify the signature on the SVT. The hash algorithm MUST be the same hash algorithm used when signing the SVT as specified by the <spanx style="verb">alg</spanx> header parameter.</t>
</list></t>

</section>
</section>
<section anchor="iana" title="IANA Considerations">

<t>This document has no IANA actions.</t>

</section>
<section anchor="seccons" title="Security Considerations">

<t>The security considerations of <xref target="SVT"/> applies also to this document.</t>

</section>


  </middle>

  <back>

    <references title='Normative References'>

&RFC2119;
&RFC5280;
&RFC7515;
&RFC8174;
<reference anchor="XMLDSIG11" >
  <front>
    <title>XML Signature Syntax and Processing Version 1.1</title>
    <author initials="D." surname="Eastlake" fullname="Donald Eastlake">
      <organization></organization>
    </author>
    <author initials="J." surname="Reagle" fullname="Joseph Reagle">
      <organization></organization>
    </author>
    <author initials="D." surname="Solo" fullname="David Solo">
      <organization></organization>
    </author>
    <author initials="F." surname="Hirsch" fullname="Frederick Hirsch">
      <organization></organization>
    </author>
    <author initials="M." surname="Nystrom" fullname="Magnus Nystrom">
      <organization></organization>
    </author>
    <author initials="T." surname="Roessler" fullname="Thomas Roessler">
      <organization></organization>
    </author>
    <author initials="K." surname="Yiu" fullname="Kelvin Yiu">
      <organization></organization>
    </author>
    <date year="2013" month="April" day="11"/>
  </front>
  <seriesInfo name="W3C" value="Proposed Recommendation"/>
</reference>
<reference anchor="SVT" >
  <front>
    <title>Signature Validation Token</title>
    <author initials="S." surname="Santesson" fullname="Stefan Santesson">
      <organization></organization>
    </author>
    <author initials="R." surname="Housley" fullname="Russ Housley">
      <organization></organization>
    </author>
    <date year="2021" month="September"/>
  </front>
  <seriesInfo name="IETF" value="draft-santesson-svt-02"/>
</reference>


    </references>




  </back>

<!-- ##markdown-source:
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

-->

</rfc>

